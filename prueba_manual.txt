üîÑ Ejecutando tarea de expiraci√≥n de suscripciones...
[Nest] 40  - 07/27/2025, 7:00:00 AM     LOG [SubscriptionExpirationService] ‚ö†Ô∏è Verificando trials que vencen pronto...
query: SELECT "subscription"."id" AS "subscription_id", "subscription"."created_at" AS "subscription_created_at", "subscription"."updated_at" AS "subscription_updated_at", "subscription"."deleted_at" AS "subscription_deleted_at", "subscription"."organizationId" AS "subscription_organizationId", "subscription"."plan" AS "subscription_plan", "subscription"."status" AS "subscription_status", "subscription"."type" AS "subscription_type", "subscription"."startDate" AS "subscription_startDate", "subscription"."endDate" AS "subscription_endDate", "subscription"."cancelledAt" AS "subscription_cancelledAt", "subscription"."cancelReason" AS "subscription_cancelReason", "subscription"."price" AS "subscription_price", "subscription"."currency" AS "subscription_currency", "subscription"."paymentMethod" AS "subscription_paymentMethod", "subscription"."externalSubscriptionId" AS "subscription_externalSubscriptionId", "subscription"."metadata" AS "subscription_metadata", "subscription"."maxUsers" AS "subscription_maxUsers", "subscription"."lastBillingDate" AS "subscription_lastBillingDate", "subscription"."nextBillingDate" AS "subscription_nextBillingDate", "subscription"."billingCycle" AS "subscription_billingCycle", "subscription"."autoRenew" AS "subscription_autoRenew", "subscription"."trialEndsAt" AS "subscription_trialEndsAt", "subscription"."isTrialUsed" AS "subscription_isTrialUsed" FROM "subscriptions" "subscription" WHERE ( "subscription"."plan" = $1 AND "subscription"."status" = $2 AND subscription.isActive = $3 AND "subscription"."endDate" BETWEEN $4 AND $5 ) AND ( "subscription"."deleted_at" IS NULL ) -- PARAMETERS: ["trial","active",true,"2025-07-27T07:00:00.082Z","2025-07-28T07:00:00.082Z"]
query: SELECT "Subscription"."id" AS "Subscription_id", "Subscription"."created_at" AS "Subscription_created_at", "Subscription"."updated_at" AS "Subscription_updated_at", "Subscription"."deleted_at" AS "Subscription_deleted_at", "Subscription"."organizationId" AS "Subscription_organizationId", "Subscription"."plan" AS "Subscription_plan", "Subscription"."status" AS "Subscription_status", "Subscription"."type" AS "Subscription_type", "Subscription"."startDate" AS "Subscription_startDate", "Subscription"."endDate" AS "Subscription_endDate", "Subscription"."cancelledAt" AS "Subscription_cancelledAt", "Subscription"."cancelReason" AS "Subscription_cancelReason", "Subscription"."price" AS "Subscription_price", "Subscription"."currency" AS "Subscription_currency", "Subscription"."paymentMethod" AS "Subscription_paymentMethod", "Subscription"."externalSubscriptionId" AS "Subscription_externalSubscriptionId", "Subscription"."metadata" AS "Subscription_metadata", "Subscription"."maxUsers" AS "Subscription_maxUsers", "Subscription"."lastBillingDate" AS "Subscription_lastBillingDate", "Subscription"."nextBillingDate" AS "Subscription_nextBillingDate", "Subscription"."billingCycle" AS "Subscription_billingCycle", "Subscription"."autoRenew" AS "Subscription_autoRenew", "Subscription"."trialEndsAt" AS "Subscription_trialEndsAt", "Subscription"."isTrialUsed" AS "Subscription_isTrialUsed" FROM "subscriptions" "Subscription" WHERE ( (("Subscription"."status" = $1) AND ("Subscription"."endDate" < $2)) ) AND ( "Subscription"."deleted_at" IS NULL ) -- PARAMETERS: ["active","2025-07-27T07:00:00.045Z"]
‚úÖ Procesadas 0 suscripciones expiradas
query failed: SELECT "subscription"."id" AS "subscription_id", "subscription"."created_at" AS "subscription_created_at", "subscription"."updated_at" AS "subscription_updated_at", "subscription"."deleted_at" AS "subscription_deleted_at", "subscription"."organizationId" AS "subscription_organizationId", "subscription"."plan" AS "subscription_plan", "subscription"."status" AS "subscription_status", "subscription"."type" AS "subscription_type", "subscription"."startDate" AS "subscription_startDate", "subscription"."endDate" AS "subscription_endDate", "subscription"."cancelledAt" AS "subscription_cancelledAt", "subscription"."cancelReason" AS "subscription_cancelReason", "subscription"."price" AS "subscription_price", "subscription"."currency" AS "subscription_currency", "subscription"."paymentMethod" AS "subscription_paymentMethod", "subscription"."externalSubscriptionId" AS "subscription_externalSubscriptionId", "subscription"."metadata" AS "subscription_metadata", "subscription"."maxUsers" AS "subscription_maxUsers", "subscription"."lastBillingDate" AS "subscription_lastBillingDate", "subscription"."nextBillingDate" AS "subscription_nextBillingDate", "subscription"."billingCycle" AS "subscription_billingCycle", "subscription"."autoRenew" AS "subscription_autoRenew", "subscription"."trialEndsAt" AS "subscription_trialEndsAt", "subscription"."isTrialUsed" AS "subscription_isTrialUsed" FROM "subscriptions" "subscription" WHERE ( "subscription"."plan" = $1 AND "subscription"."status" = $2 AND subscription.isActive = $3 AND "subscription"."endDate" BETWEEN $4 AND $5 ) AND ( "subscription"."deleted_at" IS NULL ) -- PARAMETERS: ["trial","active",true,"2025-07-27T07:00:00.082Z","2025-07-28T07:00:00.082Z"]
error: error: column subscription.isactive does not exist
[Nest] 40  - 07/27/2025, 7:00:00 AM   ERROR [SubscriptionExpirationService] ‚ùå Error verificando trials por vencer:
[Nest] 40  - 07/27/2025, 7:00:00 AM   ERROR [SubscriptionExpirationService] QueryFailedError: column subscription.isactive does not exist
